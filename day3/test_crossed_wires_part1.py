from crossed_wires import FuelManagementSystem
import pytest


class Test1:
    @pytest.fixture
    def fms(self):
        return FuelManagementSystem("R8,U5,L5,D3", "U7,R6,D4,L4")

    @pytest.fixture
    def trace_dir1(self, fms):
        return fms._trace_dir(fms.wire1)

    @pytest.fixture
    def trace_dir2(self, fms):
        return fms._trace_dir(fms.wire2)

    def test_trace_dir1(self, trace_dir1):
        assert trace_dir1 == [("R", 8), ("U", 5), ("L", 5), ("D", 3)]

    def test_trace_dir2(self, trace_dir2):
        assert trace_dir2 == [("U", 7), ("R", 6), ("D", 4), ("L", 4)]

    @pytest.fixture
    def mat_boundaries1(self, fms, trace_dir1):
        return fms._mat_boundaries(trace_dir1)

    @pytest.fixture
    def mat_boundaries2(self, fms, trace_dir2):
        return fms._mat_boundaries(trace_dir2)

    def test_mat_boundaries1(self, mat_boundaries1):
        assert mat_boundaries1 == (0, 5, 0, 8)

    def test_mat_boundaries2(self, mat_boundaries2):
        assert mat_boundaries2 == (0, 7, 0, 6)

    @pytest.fixture()
    def origin_offset(self, fms, mat_boundaries1, mat_boundaries2):
        x_offset, y_offset = fms._origin_offset(mat_boundaries1, mat_boundaries2)
        return x_offset, y_offset

    def test_x_offset(self, fms, origin_offset):
        x_offset = origin_offset[0]
        assert x_offset == 0

    def test_y_offset(self, fms, origin_offset):
        y_offset = origin_offset[1]
        assert y_offset == 0

    @pytest.fixture
    def trace_coord1(self, fms, trace_dir1, origin_offset):
        return fms._trace_coord(trace_dir1, origin_offset)

    @pytest.fixture
    def trace_coord2(self, fms, trace_dir2, origin_offset):
        return fms._trace_coord(trace_dir2, origin_offset)

    def test_trace_coord1(self, trace_coord1):
        assert trace_coord1 == [
            (0, 0),
            (1, 0),
            (2, 0),
            (3, 0),
            (4, 0),
            (5, 0),
            (6, 0),
            (7, 0),
            (8, 0),
            (8, 1),
            (8, 2),
            (8, 3),
            (8, 4),
            (8, 5),
            (7, 5),
            (6, 5),
            (5, 5),
            (4, 5),
            (3, 5),
            (3, 4),
            (3, 3),
            (3, 2),
        ]

    def test_trace_coord2(self, trace_coord2):
        assert trace_coord2 == [
            (0, 0),
            (0, 1),
            (0, 2),
            (0, 3),
            (0, 4),
            (0, 5),
            (0, 6),
            (0, 7),
            (1, 7),
            (2, 7),
            (3, 7),
            (4, 7),
            (5, 7),
            (6, 7),
            (6, 6),
            (6, 5),
            (6, 4),
            (6, 3),
            (5, 3),
            (4, 3),
            (3, 3),
            (2, 3),
        ]

    @pytest.fixture
    def mat_shape(self, fms, trace_coord1, trace_coord2):
        return fms._mat_shape(trace_coord1, trace_coord2)

    def test_mat_shape(self, mat_shape):
        assert mat_shape == (8, 9)

    @pytest.fixture
    def mat_trace1(self, fms, trace_coord1, mat_shape, origin_offset):
        return fms._mat_trace(trace_coord1, mat_shape, origin_offset)

    @pytest.fixture
    def mat_trace2(self, fms, trace_coord2, mat_shape, origin_offset):
        return fms._mat_trace(trace_coord2, mat_shape, origin_offset)

    def test_mat_trace1(self, trace_coord1, mat_trace1):
        for x_i, y_i in trace_coord1[1:]:
            assert mat_trace1[y_i][x_i] >= 1

    def test_mat_trace2(self, trace_coord2, mat_trace2):
        for x_i, y_i in trace_coord2[1:]:
            assert mat_trace2[y_i][x_i] >= 1

    @pytest.fixture
    def intersections(self, fms, mat_trace1, mat_trace2):
        return fms._intersections(mat_trace1, mat_trace2)

    @pytest.fixture
    def manhattan_dist_intersection_min(self, fms, intersections, origin_offset):
        return fms._manhattan_dist_intersection_min(intersections, origin_offset)

    def test_manhattan_dist_intersection_min(self, manhattan_dist_intersection_min):
        assert manhattan_dist_intersection_min == 6


class Test2:
    @pytest.fixture
    def fms(self):
        wire1 = "R75,D30,R83,U83,L12,D49,R71,U7,L72"
        wire2 = "U62,R66,U55,R34,D71,R55,D58,R83"
        return FuelManagementSystem(wire1, wire2)

    @pytest.fixture
    def trace_dir1(self, fms):
        return fms._trace_dir(fms.wire1)

    @pytest.fixture
    def trace_dir2(self, fms):
        return fms._trace_dir(fms.wire2)

    def test_trace_dir1(self, trace_dir1):
        assert trace_dir1 == [
            ("R", 75),
            ("D", 30),
            ("R", 83),
            ("U", 83),
            ("L", 12),
            ("D", 49),
            ("R", 71),
            ("U", 7),
            ("L", 72),
        ]

    def test_trace_dir2(self, trace_dir2):
        assert trace_dir2 == [
            ("U", 62),
            ("R", 66),
            ("U", 55),
            ("R", 34),
            ("D", 71),
            ("R", 55),
            ("D", 58),
            ("R", 83),
        ]

    @pytest.fixture
    def mat_boundaries1(self, fms, trace_dir1):
        return fms._mat_boundaries(trace_dir1)

    @pytest.fixture
    def mat_boundaries2(self, fms, trace_dir2):
        return fms._mat_boundaries(trace_dir2)

    def test_mat_boundaries1(self, mat_boundaries1):
        assert mat_boundaries1 == (0, 53, -30, 217)

    def test_mat_boundaries2(self, mat_boundaries2):
        assert mat_boundaries2 == (0, 117, -12, 238)

    @pytest.fixture()
    def origin_offset(self, fms, mat_boundaries1, mat_boundaries2):
        x_offset, y_offset = fms._origin_offset(mat_boundaries1, mat_boundaries2)
        return x_offset, y_offset

    def test_x_offset(self, origin_offset):
        x_offset = origin_offset[0]
        assert x_offset == 0

    def test_y_offset(self, origin_offset):
        y_offset = origin_offset[1]
        assert y_offset == 30

    @pytest.fixture
    def trace_coord1(self, fms, trace_dir1, origin_offset):
        return fms._trace_coord(trace_dir1, origin_offset)

    @pytest.fixture
    def trace_coord2(self, fms, trace_dir2, origin_offset):
        return fms._trace_coord(trace_dir2, origin_offset)

    def test_trace_coord1(self, trace_coord1):
        assert trace_coord1 == [
            (0, 30),
            (1, 30),
            (2, 30),
            (3, 30),
            (4, 30),
            (5, 30),
            (6, 30),
            (7, 30),
            (8, 30),
            (9, 30),
            (10, 30),
            (11, 30),
            (12, 30),
            (13, 30),
            (14, 30),
            (15, 30),
            (16, 30),
            (17, 30),
            (18, 30),
            (19, 30),
            (20, 30),
            (21, 30),
            (22, 30),
            (23, 30),
            (24, 30),
            (25, 30),
            (26, 30),
            (27, 30),
            (28, 30),
            (29, 30),
            (30, 30),
            (31, 30),
            (32, 30),
            (33, 30),
            (34, 30),
            (35, 30),
            (36, 30),
            (37, 30),
            (38, 30),
            (39, 30),
            (40, 30),
            (41, 30),
            (42, 30),
            (43, 30),
            (44, 30),
            (45, 30),
            (46, 30),
            (47, 30),
            (48, 30),
            (49, 30),
            (50, 30),
            (51, 30),
            (52, 30),
            (53, 30),
            (54, 30),
            (55, 30),
            (56, 30),
            (57, 30),
            (58, 30),
            (59, 30),
            (60, 30),
            (61, 30),
            (62, 30),
            (63, 30),
            (64, 30),
            (65, 30),
            (66, 30),
            (67, 30),
            (68, 30),
            (69, 30),
            (70, 30),
            (71, 30),
            (72, 30),
            (73, 30),
            (74, 30),
            (75, 30),
            (75, 29),
            (75, 28),
            (75, 27),
            (75, 26),
            (75, 25),
            (75, 24),
            (75, 23),
            (75, 22),
            (75, 21),
            (75, 20),
            (75, 19),
            (75, 18),
            (75, 17),
            (75, 16),
            (75, 15),
            (75, 14),
            (75, 13),
            (75, 12),
            (75, 11),
            (75, 10),
            (75, 9),
            (75, 8),
            (75, 7),
            (75, 6),
            (75, 5),
            (75, 4),
            (75, 3),
            (75, 2),
            (75, 1),
            (75, 0),
            (76, 0),
            (77, 0),
            (78, 0),
            (79, 0),
            (80, 0),
            (81, 0),
            (82, 0),
            (83, 0),
            (84, 0),
            (85, 0),
            (86, 0),
            (87, 0),
            (88, 0),
            (89, 0),
            (90, 0),
            (91, 0),
            (92, 0),
            (93, 0),
            (94, 0),
            (95, 0),
            (96, 0),
            (97, 0),
            (98, 0),
            (99, 0),
            (100, 0),
            (101, 0),
            (102, 0),
            (103, 0),
            (104, 0),
            (105, 0),
            (106, 0),
            (107, 0),
            (108, 0),
            (109, 0),
            (110, 0),
            (111, 0),
            (112, 0),
            (113, 0),
            (114, 0),
            (115, 0),
            (116, 0),
            (117, 0),
            (118, 0),
            (119, 0),
            (120, 0),
            (121, 0),
            (122, 0),
            (123, 0),
            (124, 0),
            (125, 0),
            (126, 0),
            (127, 0),
            (128, 0),
            (129, 0),
            (130, 0),
            (131, 0),
            (132, 0),
            (133, 0),
            (134, 0),
            (135, 0),
            (136, 0),
            (137, 0),
            (138, 0),
            (139, 0),
            (140, 0),
            (141, 0),
            (142, 0),
            (143, 0),
            (144, 0),
            (145, 0),
            (146, 0),
            (147, 0),
            (148, 0),
            (149, 0),
            (150, 0),
            (151, 0),
            (152, 0),
            (153, 0),
            (154, 0),
            (155, 0),
            (156, 0),
            (157, 0),
            (158, 0),
            (158, 1),
            (158, 2),
            (158, 3),
            (158, 4),
            (158, 5),
            (158, 6),
            (158, 7),
            (158, 8),
            (158, 9),
            (158, 10),
            (158, 11),
            (158, 12),
            (158, 13),
            (158, 14),
            (158, 15),
            (158, 16),
            (158, 17),
            (158, 18),
            (158, 19),
            (158, 20),
            (158, 21),
            (158, 22),
            (158, 23),
            (158, 24),
            (158, 25),
            (158, 26),
            (158, 27),
            (158, 28),
            (158, 29),
            (158, 30),
            (158, 31),
            (158, 32),
            (158, 33),
            (158, 34),
            (158, 35),
            (158, 36),
            (158, 37),
            (158, 38),
            (158, 39),
            (158, 40),
            (158, 41),
            (158, 42),
            (158, 43),
            (158, 44),
            (158, 45),
            (158, 46),
            (158, 47),
            (158, 48),
            (158, 49),
            (158, 50),
            (158, 51),
            (158, 52),
            (158, 53),
            (158, 54),
            (158, 55),
            (158, 56),
            (158, 57),
            (158, 58),
            (158, 59),
            (158, 60),
            (158, 61),
            (158, 62),
            (158, 63),
            (158, 64),
            (158, 65),
            (158, 66),
            (158, 67),
            (158, 68),
            (158, 69),
            (158, 70),
            (158, 71),
            (158, 72),
            (158, 73),
            (158, 74),
            (158, 75),
            (158, 76),
            (158, 77),
            (158, 78),
            (158, 79),
            (158, 80),
            (158, 81),
            (158, 82),
            (158, 83),
            (157, 83),
            (156, 83),
            (155, 83),
            (154, 83),
            (153, 83),
            (152, 83),
            (151, 83),
            (150, 83),
            (149, 83),
            (148, 83),
            (147, 83),
            (146, 83),
            (146, 82),
            (146, 81),
            (146, 80),
            (146, 79),
            (146, 78),
            (146, 77),
            (146, 76),
            (146, 75),
            (146, 74),
            (146, 73),
            (146, 72),
            (146, 71),
            (146, 70),
            (146, 69),
            (146, 68),
            (146, 67),
            (146, 66),
            (146, 65),
            (146, 64),
            (146, 63),
            (146, 62),
            (146, 61),
            (146, 60),
            (146, 59),
            (146, 58),
            (146, 57),
            (146, 56),
            (146, 55),
            (146, 54),
            (146, 53),
            (146, 52),
            (146, 51),
            (146, 50),
            (146, 49),
            (146, 48),
            (146, 47),
            (146, 46),
            (146, 45),
            (146, 44),
            (146, 43),
            (146, 42),
            (146, 41),
            (146, 40),
            (146, 39),
            (146, 38),
            (146, 37),
            (146, 36),
            (146, 35),
            (146, 34),
            (147, 34),
            (148, 34),
            (149, 34),
            (150, 34),
            (151, 34),
            (152, 34),
            (153, 34),
            (154, 34),
            (155, 34),
            (156, 34),
            (157, 34),
            (158, 34),
            (159, 34),
            (160, 34),
            (161, 34),
            (162, 34),
            (163, 34),
            (164, 34),
            (165, 34),
            (166, 34),
            (167, 34),
            (168, 34),
            (169, 34),
            (170, 34),
            (171, 34),
            (172, 34),
            (173, 34),
            (174, 34),
            (175, 34),
            (176, 34),
            (177, 34),
            (178, 34),
            (179, 34),
            (180, 34),
            (181, 34),
            (182, 34),
            (183, 34),
            (184, 34),
            (185, 34),
            (186, 34),
            (187, 34),
            (188, 34),
            (189, 34),
            (190, 34),
            (191, 34),
            (192, 34),
            (193, 34),
            (194, 34),
            (195, 34),
            (196, 34),
            (197, 34),
            (198, 34),
            (199, 34),
            (200, 34),
            (201, 34),
            (202, 34),
            (203, 34),
            (204, 34),
            (205, 34),
            (206, 34),
            (207, 34),
            (208, 34),
            (209, 34),
            (210, 34),
            (211, 34),
            (212, 34),
            (213, 34),
            (214, 34),
            (215, 34),
            (216, 34),
            (217, 34),
            (217, 35),
            (217, 36),
            (217, 37),
            (217, 38),
            (217, 39),
            (217, 40),
            (217, 41),
            (216, 41),
            (215, 41),
            (214, 41),
            (213, 41),
            (212, 41),
            (211, 41),
            (210, 41),
            (209, 41),
            (208, 41),
            (207, 41),
            (206, 41),
            (205, 41),
            (204, 41),
            (203, 41),
            (202, 41),
            (201, 41),
            (200, 41),
            (199, 41),
            (198, 41),
            (197, 41),
            (196, 41),
            (195, 41),
            (194, 41),
            (193, 41),
            (192, 41),
            (191, 41),
            (190, 41),
            (189, 41),
            (188, 41),
            (187, 41),
            (186, 41),
            (185, 41),
            (184, 41),
            (183, 41),
            (182, 41),
            (181, 41),
            (180, 41),
            (179, 41),
            (178, 41),
            (177, 41),
            (176, 41),
            (175, 41),
            (174, 41),
            (173, 41),
            (172, 41),
            (171, 41),
            (170, 41),
            (169, 41),
            (168, 41),
            (167, 41),
            (166, 41),
            (165, 41),
            (164, 41),
            (163, 41),
            (162, 41),
            (161, 41),
            (160, 41),
            (159, 41),
            (158, 41),
            (157, 41),
            (156, 41),
            (155, 41),
            (154, 41),
            (153, 41),
            (152, 41),
            (151, 41),
            (150, 41),
            (149, 41),
            (148, 41),
            (147, 41),
            (146, 41),
            (145, 41),
        ]

    def test_trace_coord2(self, trace_coord2):
        assert trace_coord2 == [
            (0, 30),
            (0, 31),
            (0, 32),
            (0, 33),
            (0, 34),
            (0, 35),
            (0, 36),
            (0, 37),
            (0, 38),
            (0, 39),
            (0, 40),
            (0, 41),
            (0, 42),
            (0, 43),
            (0, 44),
            (0, 45),
            (0, 46),
            (0, 47),
            (0, 48),
            (0, 49),
            (0, 50),
            (0, 51),
            (0, 52),
            (0, 53),
            (0, 54),
            (0, 55),
            (0, 56),
            (0, 57),
            (0, 58),
            (0, 59),
            (0, 60),
            (0, 61),
            (0, 62),
            (0, 63),
            (0, 64),
            (0, 65),
            (0, 66),
            (0, 67),
            (0, 68),
            (0, 69),
            (0, 70),
            (0, 71),
            (0, 72),
            (0, 73),
            (0, 74),
            (0, 75),
            (0, 76),
            (0, 77),
            (0, 78),
            (0, 79),
            (0, 80),
            (0, 81),
            (0, 82),
            (0, 83),
            (0, 84),
            (0, 85),
            (0, 86),
            (0, 87),
            (0, 88),
            (0, 89),
            (0, 90),
            (0, 91),
            (0, 92),
            (1, 92),
            (2, 92),
            (3, 92),
            (4, 92),
            (5, 92),
            (6, 92),
            (7, 92),
            (8, 92),
            (9, 92),
            (10, 92),
            (11, 92),
            (12, 92),
            (13, 92),
            (14, 92),
            (15, 92),
            (16, 92),
            (17, 92),
            (18, 92),
            (19, 92),
            (20, 92),
            (21, 92),
            (22, 92),
            (23, 92),
            (24, 92),
            (25, 92),
            (26, 92),
            (27, 92),
            (28, 92),
            (29, 92),
            (30, 92),
            (31, 92),
            (32, 92),
            (33, 92),
            (34, 92),
            (35, 92),
            (36, 92),
            (37, 92),
            (38, 92),
            (39, 92),
            (40, 92),
            (41, 92),
            (42, 92),
            (43, 92),
            (44, 92),
            (45, 92),
            (46, 92),
            (47, 92),
            (48, 92),
            (49, 92),
            (50, 92),
            (51, 92),
            (52, 92),
            (53, 92),
            (54, 92),
            (55, 92),
            (56, 92),
            (57, 92),
            (58, 92),
            (59, 92),
            (60, 92),
            (61, 92),
            (62, 92),
            (63, 92),
            (64, 92),
            (65, 92),
            (66, 92),
            (66, 93),
            (66, 94),
            (66, 95),
            (66, 96),
            (66, 97),
            (66, 98),
            (66, 99),
            (66, 100),
            (66, 101),
            (66, 102),
            (66, 103),
            (66, 104),
            (66, 105),
            (66, 106),
            (66, 107),
            (66, 108),
            (66, 109),
            (66, 110),
            (66, 111),
            (66, 112),
            (66, 113),
            (66, 114),
            (66, 115),
            (66, 116),
            (66, 117),
            (66, 118),
            (66, 119),
            (66, 120),
            (66, 121),
            (66, 122),
            (66, 123),
            (66, 124),
            (66, 125),
            (66, 126),
            (66, 127),
            (66, 128),
            (66, 129),
            (66, 130),
            (66, 131),
            (66, 132),
            (66, 133),
            (66, 134),
            (66, 135),
            (66, 136),
            (66, 137),
            (66, 138),
            (66, 139),
            (66, 140),
            (66, 141),
            (66, 142),
            (66, 143),
            (66, 144),
            (66, 145),
            (66, 146),
            (66, 147),
            (67, 147),
            (68, 147),
            (69, 147),
            (70, 147),
            (71, 147),
            (72, 147),
            (73, 147),
            (74, 147),
            (75, 147),
            (76, 147),
            (77, 147),
            (78, 147),
            (79, 147),
            (80, 147),
            (81, 147),
            (82, 147),
            (83, 147),
            (84, 147),
            (85, 147),
            (86, 147),
            (87, 147),
            (88, 147),
            (89, 147),
            (90, 147),
            (91, 147),
            (92, 147),
            (93, 147),
            (94, 147),
            (95, 147),
            (96, 147),
            (97, 147),
            (98, 147),
            (99, 147),
            (100, 147),
            (100, 146),
            (100, 145),
            (100, 144),
            (100, 143),
            (100, 142),
            (100, 141),
            (100, 140),
            (100, 139),
            (100, 138),
            (100, 137),
            (100, 136),
            (100, 135),
            (100, 134),
            (100, 133),
            (100, 132),
            (100, 131),
            (100, 130),
            (100, 129),
            (100, 128),
            (100, 127),
            (100, 126),
            (100, 125),
            (100, 124),
            (100, 123),
            (100, 122),
            (100, 121),
            (100, 120),
            (100, 119),
            (100, 118),
            (100, 117),
            (100, 116),
            (100, 115),
            (100, 114),
            (100, 113),
            (100, 112),
            (100, 111),
            (100, 110),
            (100, 109),
            (100, 108),
            (100, 107),
            (100, 106),
            (100, 105),
            (100, 104),
            (100, 103),
            (100, 102),
            (100, 101),
            (100, 100),
            (100, 99),
            (100, 98),
            (100, 97),
            (100, 96),
            (100, 95),
            (100, 94),
            (100, 93),
            (100, 92),
            (100, 91),
            (100, 90),
            (100, 89),
            (100, 88),
            (100, 87),
            (100, 86),
            (100, 85),
            (100, 84),
            (100, 83),
            (100, 82),
            (100, 81),
            (100, 80),
            (100, 79),
            (100, 78),
            (100, 77),
            (100, 76),
            (101, 76),
            (102, 76),
            (103, 76),
            (104, 76),
            (105, 76),
            (106, 76),
            (107, 76),
            (108, 76),
            (109, 76),
            (110, 76),
            (111, 76),
            (112, 76),
            (113, 76),
            (114, 76),
            (115, 76),
            (116, 76),
            (117, 76),
            (118, 76),
            (119, 76),
            (120, 76),
            (121, 76),
            (122, 76),
            (123, 76),
            (124, 76),
            (125, 76),
            (126, 76),
            (127, 76),
            (128, 76),
            (129, 76),
            (130, 76),
            (131, 76),
            (132, 76),
            (133, 76),
            (134, 76),
            (135, 76),
            (136, 76),
            (137, 76),
            (138, 76),
            (139, 76),
            (140, 76),
            (141, 76),
            (142, 76),
            (143, 76),
            (144, 76),
            (145, 76),
            (146, 76),
            (147, 76),
            (148, 76),
            (149, 76),
            (150, 76),
            (151, 76),
            (152, 76),
            (153, 76),
            (154, 76),
            (155, 76),
            (155, 75),
            (155, 74),
            (155, 73),
            (155, 72),
            (155, 71),
            (155, 70),
            (155, 69),
            (155, 68),
            (155, 67),
            (155, 66),
            (155, 65),
            (155, 64),
            (155, 63),
            (155, 62),
            (155, 61),
            (155, 60),
            (155, 59),
            (155, 58),
            (155, 57),
            (155, 56),
            (155, 55),
            (155, 54),
            (155, 53),
            (155, 52),
            (155, 51),
            (155, 50),
            (155, 49),
            (155, 48),
            (155, 47),
            (155, 46),
            (155, 45),
            (155, 44),
            (155, 43),
            (155, 42),
            (155, 41),
            (155, 40),
            (155, 39),
            (155, 38),
            (155, 37),
            (155, 36),
            (155, 35),
            (155, 34),
            (155, 33),
            (155, 32),
            (155, 31),
            (155, 30),
            (155, 29),
            (155, 28),
            (155, 27),
            (155, 26),
            (155, 25),
            (155, 24),
            (155, 23),
            (155, 22),
            (155, 21),
            (155, 20),
            (155, 19),
            (155, 18),
            (156, 18),
            (157, 18),
            (158, 18),
            (159, 18),
            (160, 18),
            (161, 18),
            (162, 18),
            (163, 18),
            (164, 18),
            (165, 18),
            (166, 18),
            (167, 18),
            (168, 18),
            (169, 18),
            (170, 18),
            (171, 18),
            (172, 18),
            (173, 18),
            (174, 18),
            (175, 18),
            (176, 18),
            (177, 18),
            (178, 18),
            (179, 18),
            (180, 18),
            (181, 18),
            (182, 18),
            (183, 18),
            (184, 18),
            (185, 18),
            (186, 18),
            (187, 18),
            (188, 18),
            (189, 18),
            (190, 18),
            (191, 18),
            (192, 18),
            (193, 18),
            (194, 18),
            (195, 18),
            (196, 18),
            (197, 18),
            (198, 18),
            (199, 18),
            (200, 18),
            (201, 18),
            (202, 18),
            (203, 18),
            (204, 18),
            (205, 18),
            (206, 18),
            (207, 18),
            (208, 18),
            (209, 18),
            (210, 18),
            (211, 18),
            (212, 18),
            (213, 18),
            (214, 18),
            (215, 18),
            (216, 18),
            (217, 18),
            (218, 18),
            (219, 18),
            (220, 18),
            (221, 18),
            (222, 18),
            (223, 18),
            (224, 18),
            (225, 18),
            (226, 18),
            (227, 18),
            (228, 18),
            (229, 18),
            (230, 18),
            (231, 18),
            (232, 18),
            (233, 18),
            (234, 18),
            (235, 18),
            (236, 18),
            (237, 18),
            (238, 18),
        ]

    @pytest.fixture
    def mat_shape(self, fms, trace_coord1, trace_coord2):
        return fms._mat_shape(trace_coord1, trace_coord2)

    def test_mat_shape(self, mat_shape):
        assert mat_shape == (148, 239)

    @pytest.fixture
    def mat_trace1(self, fms, trace_coord1, mat_shape, origin_offset):
        return fms._mat_trace(trace_coord1, mat_shape, origin_offset)

    @pytest.fixture
    def mat_trace2(self, fms, trace_coord2, mat_shape, origin_offset):
        return fms._mat_trace(trace_coord2, mat_shape, origin_offset)

    def test_mat_trace1(self, trace_coord1, mat_trace1):
        for x_i, y_i in trace_coord1[1:]:
            assert mat_trace1[y_i][x_i] >= 1

    def test_mat_trace2(self, trace_coord2, mat_trace2):
        for x_i, y_i in trace_coord2[1:]:
            assert mat_trace2[y_i][x_i] >= 1

    @pytest.fixture
    def intersections(self, fms, mat_trace1, mat_trace2):
        return fms._intersections(mat_trace1, mat_trace2)

    @pytest.fixture
    def manhattan_dist_intersection_min(self, fms, intersections, origin_offset):
        return fms._manhattan_dist_intersection_min(intersections, origin_offset)

    def test_manhattan_dist_intersection_min(self, manhattan_dist_intersection_min):
        assert manhattan_dist_intersection_min == 159


class Test3:
    @pytest.fixture
    def fms(self):
        return FuelManagementSystem(
            "R98,U47,R26,D63,R33,U87,L62,D20,R33,U53,R51",
            "U98,R91,D20,R16,D67,R40,U7,R15,U6,R7",
        )

    def test_manhattan_dist_intersection_min(self, fms):
        assert fms.manhattan_dist_intersection_min() == 135
